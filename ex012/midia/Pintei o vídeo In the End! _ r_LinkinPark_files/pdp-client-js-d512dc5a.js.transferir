import"./open-interstitial-modal-6017c1ea.js";import"./confirm-over-18-4984b0f6.js";import{a5 as t,a6 as e,i,c as s,_ as n,n as o,t as a,s as r,l,dK as d,dL as c,x as p,d as h,f as m,e as u,a0 as f,p as b,r as g,bh as x,a_ as j}from"./shell-44808257.js";import"./reddit-page-data-a03dba12.js";import"./shreddit-comments-page-ad-1297dbb1.js";import"./shreddit-tweet-embed-433a9394.js";import"./icon-caret-right-cf90a50d.js";import"./faceplate-tabgroup-418a5313.js";import"./faceplate-tabpanel-162190c5.js";import"./shreddit-search-e91b2aa9.js";import"./shreddit-lead-generation-ad-dialog-a48d0978.js";import"./comment-body-header-b78cbe0d.js";import"./author-flair-event-handler-90878398.js";import"./mod-notes-opener-1222a767.js";import"./shreddit-join-link-fa661e5e.js";import"./guard-community-modal-e6e72fc5.js";import"./index-9a542472.js";import"./index-7218339a.js";import"./ref-a51be9a2.js";import"./icon-play-5b0e5040.js";import"./faceplate-tablist-584a0e36.js";import"./pageable-8c01eaad.js";import"./icon-caret-left-outline-6efe1eb2.js";import"./icon-caret-right-outline-098350eb.js";import"./icon-search-55f66fc9.js";import"./search-helpers-8a66ab8d.js";import"./faceplate-bottom-sheet-a7ae593e.js";import"./TinyGesture-f59f0025.js";import"./faceplate-bottom-sheet-header-d4e04523.js";import"./faceplate-text-input-7a797177.js";import"./faceplate-checkbox-input-3c5194b2.js";import"./checked-input-element-0e1c4eca.js";import"./comment-composer-host-619933e5.js";import"./rte-toolbar-button-emote-8e4faded.js";import"./mention-node-59bd1573.js";import"./icon-delete-outline-47a04294.js";import"./icon-edit-outline-51d07a12.js";import"./upload-to-s3-4fbd0891.js";import"./faceplate-tooltip-cd26ff33.js";import"./composer-7ff0681f.js";import"./faceplate-progress-5b44287d.js";import"./telemetry-event-struct-895ecb8c.js";import"./commentsPage-14084ccb.js";import"./icon-new-9de46dea.js";import"./icon-archived-54762430.js";import"./mod-notes-5d8f45dd.js";import"./icon-spoiler-outline-46925753.js";import"./icon-privacy-outline-d2ca8b61.js";const{svg:T}=t();var v=e(T`<path d="M17.375 2H2.625A2.629 2.629 0 0 0 0 4.625v10.75A2.63 2.63 0 0 0 2.625 18h14.75A2.63 2.63 0 0 0 20 15.375V4.625A2.63 2.63 0 0 0 17.375 2Zm1.375 13.375a1.377 1.377 0 0 1-1.375 1.375H2.625a1.377 1.377 0 0 1-1.375-1.375V4.625A1.377 1.377 0 0 1 2.625 3.25h14.75a1.377 1.377 0 0 1 1.375 1.375v10.75Zm-2.2-5.7.029.589-.212.254-2.929 2.929-.884-.884L15.116 10l-2.558-2.558.884-.884 3.108 3.117ZM7.442 7.442 4.884 10l2.558 2.558-.884.884-3.112-3.112-.029-.589.212-.254 2.929-2.929.884.884ZM9.375 6h1.25v8h-1.25V6Z"></path>`,"0 0 20 20","embed-outline");const C=t=>t.replace(/\n/g,"").replace(/\s+/g," ").trim(),S=({commentId:t,noPrefix:e})=>{let i=t.replace("-comment-rtjson-content","");return e&&(i=i.replace("t1_","")),i},y=({commentId:t,permalink:e,snippetData:i})=>t?`https://publish.reddit.com/embed?url=https://www.reddit.com${e.replace(/\/[^/]+(?=\/$)|\/$/,"")}comment/${S({commentId:t,noPrefix:!0})}?snippet=${i}`:`https://publish.reddit.com/embed?url=https://www.reddit.com${e}?snippet=${i}`,k=["TR","TH","TD","TABLE","TBODY","THEAD"],w=new Set(["H1","P"]);let E=class extends r{constructor(){super(...arguments),this.titleHeight=0,this.postId="",this.permalink="",this.topOffset=0,this.leftOffset=0,this.snippetData="",this.isTitleSelected=!1,this.isSelectionOutOfRange=!1,this.isFullTextSelected=!1,this.isComment=!1,this.clearSelection=t=>{if(2!==t.button&&t.target.getAttribute("postid")!==this.postId){const e=((t,e)=>{for(;t;){if(t.id&&(t.id.includes(`${e}-post-rtjson-content`)||t.id.includes("-comment-rtjson-content")))return t;t=t.parentNode}return null})(t.target,this.postId);this.richTextContainer=e,getSelection()?.empty(),this.snippetData="",this.isTitleSelected=!1,this.isSelectionOutOfRange=!1,this.isFullTextSelected=!1}},this.handleEmbedClick=()=>{this.isComment&&this.richTextContainer?.id?open(y({commentId:this.richTextContainer?.id,permalink:this.permalink,snippetData:this.snippetData}),"RedditEmbed"):open(y({permalink:this.permalink,snippetData:this.snippetData}),"RedditEmbed"),this.sendClickTelemetry()},this.isTripleClickHandled=t=>3===t.detail,this.getChildTextNode=t=>{let e;const i=t.childNodes;for(let t=0;t<i.length;t++){const s=i[t];if("#text"!==s.nodeName)continue;0!==C(s.textContent||"").length&&(e=s)}return e},this.getCorrectSelection=t=>{const e=getSelection();if(this.isTripleClickHandled(t)&&e?.anchorNode?.nodeName&&w.has(e?.anchorNode?.nodeName)){const t=this.getChildTextNode(e.anchorNode),i=t?.textContent?.length||0;e.setBaseAndExtent(t,0,t,i)}return e},this.calculateSnippetData=t=>{if(this.shouldShowButton)return void this.clearSelection(t);this.isComment=Boolean(this.richTextContainer?.id&&this.richTextContainer.id.startsWith("t1")),this.snippetData="";const e=this.getCorrectSelection(t),i=C(e?.toString()||"");if(!e||!i?.length)return;const s=this.richTextContainer?C(this.richTextContainer.innerText):"",n=C(this.postTitleElement.innerText);this.richTextContainer&&i===s&&(this.isFullTextSelected=!0);const o=e?.anchorNode;if(o.parentNode?.nodeName&&k.includes(o.parentNode?.nodeName))return;const a=e.getRangeAt(0);o.parentNode===this.postTitleElement&&(this.isTitleSelected=!0),(this.isTitleSelected&&i.length>n.length||this.richTextContainer&&i.length>s.length)&&(this.isSelectionOutOfRange=!0);const r=this.isTitleSelected?this.postTitleElement?.getBoundingClientRect():this.richTextContainer?.getBoundingClientRect(),l=e?.getRangeAt(0).getBoundingClientRect();if(r&&l){if(this.topOffset=l.top+scrollY,this.leftOffset=l.left+l.width/2,this.shadowRoot?.host.style.setProperty("--left-offset",`${this.leftOffset}px`),this.shadowRoot?.host.style.setProperty("--top-offset",this.topOffset-32-4+"px"),this.isTitleSelected||this.isFullTextSelected)return void this.sendViewTelemetry();if(e.rangeCount>0){let t=-1;const e=Array.from((this.isComment?this.richTextContainer?.children[0].children:this.richTextContainer?.children)||[]).filter((t=>"#text"!==t.nodeName));for(let i=0;i<e.length;i++){const s=e[i];if(a.intersectsNode(s)){t=i;break}}if(-1!==t&&i){const s=(({nodeText:t,selectedText:e})=>{if(!t||!e)return-1;const i=t.length,s=e.length,n=[];for(let t=0;t<=i;t++)n[t]=new Array(s+1).fill(0);let o=0,a=0;for(let r=1;r<=i;r++)for(let i=1;i<=s;i++)t[r-1]===e[i-1]&&(n[r][i]=n[r-1][i-1]+1,n[r][i]>o&&(o=n[r][i],a=r-1));const r=t.substring(a-o+1,a+1);return r?t.indexOf(r):-1})({nodeText:C(e[t].innerText),selectedText:i});t>-1&&s>-1&&i.length>0&&(this.snippetData=`${t}_${s}_${i.length}`,this.sendViewTelemetry())}}}},this.getEventDetails=()=>{const t={};return this.isComment&&this.richTextContainer?.id&&(t.comment={id:S({commentId:this.richTextContainer.id})}),t},this.sendViewTelemetry=()=>{const t=this.getEventDetails();this.dispatchEvent(l(d,{details:t}))},this.sendClickTelemetry=()=>{const t=this.getEventDetails();this.dispatchEvent(l(c,{details:t}))}}get shouldShowButton(){return(this.snippetData.length||this.isTitleSelected||this.isFullTextSelected)&&!this.isSelectionOutOfRange}connectedCallback(){super.connectedCallback();const t=document.getElementById(`post-title-${this.postId}`);t&&(this.postTitleElement=t,this.titleHeight=this.postTitleElement.clientHeight),document.addEventListener("mousedown",this.clearSelection),document.addEventListener("mouseup",this.calculateSnippetData)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("mousedown",this.clearSelection),document.removeEventListener("mouseup",this.calculateSnippetData)}render(){return p`\n ${this.shouldShowButton?p`\n <div class="button-container bg-neutral-content-strong rounded-full shadow-sm flex">\n ${h({appearance:"plainInverted",size:m.Small,attributes:{onclick:this.handleEmbedClick},leadingIcon:v(),children:"Incorporar"})}\n </div>\n `:""}\n `}};E.styles=[i`.button-container{position:absolute;left:var(--left-offset);top:var(--top-offset);transform:translateX(-50%);z-index:1}`,s],n([o({type:String})],E.prototype,"postId",void 0),n([o({type:String})],E.prototype,"permalink",void 0),n([a()],E.prototype,"topOffset",void 0),n([a()],E.prototype,"leftOffset",void 0),n([a()],E.prototype,"snippetData",void 0),n([a()],E.prototype,"isTitleSelected",void 0),n([a()],E.prototype,"isSelectionOutOfRange",void 0),n([a()],E.prototype,"isFullTextSelected",void 0),n([a()],E.prototype,"isComment",void 0),E=n([u("embed-snippet-share-button")],E);let D=class extends r{static get styles(){return i`:host{display:block;position:relative}`}render(){return p`\n <slot></slot>\n <slot name="link"></slot>\n `}};D=n([u("post-media-container")],D);const{svg:N}=t();var O=e(N`<path d="m18.384 18.81.013-.014L2.486 2.883l-.886.885 7.244 7.241H7.538A6.482 6.482 0 0 0 1 17.42v.482a1.114 1.114 0 0 0 1.119 1.107h14.725l.67.67.761-.762c.052-.02.102-.043.151-.068l-.042-.04ZM2.251 17.76v-.34a5.231 5.231 0 0 1 5.287-5.16h2.556l5.5 5.5H2.251ZM13.5 11.097a6.477 6.477 0 0 1 5.427 5.427l-2.6-2.6a4.795 4.795 0 0 0-.247-.247l-2.58-2.58Zm-7.1-7.1-.98-.983a5 5 0 1 1 6.574 6.574l-.985-.98a3.74 3.74 0 1 0-4.6-4.6L6.4 4Z"></path>`,"0 0 20 20","block-outline");let R=class extends r{constructor(){super(...arguments),this.replaceItselfWithChildren=()=>{this.replaceWith(...this.childNodes)}}render(){return p`<div class="mx-md xs:mx-0">\n <div \n class="items-center justify-between flex flex-row py-sm px-md w-100 bg-neutral-background border-neutral-border rounded-[8px] border-solid border box-border" \n>\n <div>\n ${O({size:f.Medium,attributes:{className:"align-middle mr-2xs"}})}\n <span class="text-neutral-content-weak">\n Postado por uma conta bloqueada\n </span>\n </div>\n\n ${h({appearance:"secondary",size:m.Small,attributes:{rel:"nofollow",id:"primary-button",onclick:this.replaceItselfWithChildren},children:"Ver post"})}\n </div>\n </div>`}};R.styles=[s],R=n([u("shreddit-blocked-post-content")],R);let $=class extends(b(r)){connectedCallback(){super.connectedCallback(),this.subscribe(g.PostUpdated,this.handlePostUpdate),this.subscribe(g.CommentUpdated,this.handleCommentUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.unsubscribe(g.PostUpdated,this.handlePostUpdate),this.unsubscribe(g.CommentUpdated,this.handleCommentUpdate)}handlePostUpdate({action:t}){t===x.addRemovalReason&&window.location.reload()}handleCommentUpdate({action:t}){t===j.addRemovalReason&&window.location.reload()}};$=n([u("shreddit-pdp-mod-actions-handler")],$),import("./faceplate-hovercard-d0236c3f.js").then((function(t){return t.f})),import("./faceplate-progress-5b44287d.js"),import("./faceplate-tooltip-cd26ff33.js");
//# sourceMappingURL=pdp-client-js-d512dc5a.js.map
